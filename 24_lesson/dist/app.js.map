{"version":3,"file":"app.js","sources":["app.js"],"sourcesContent":["class ContactAPI {\r\n  static API = 'https://64255d537ac292e3cffe899f.mockapi.io/api/contacts/'\r\n\r\n  static request(url = '', method = '', body, errorMessage) {\r\n    return fetch(ContactAPI.API + url, {\r\n      method,\r\n      body: body ? JSON.stringify(body) : undefined,\r\n      headers: {\r\n        'Content-type': 'application/json',\r\n      }\r\n    })\r\n      .then((res) => {\r\n        if (res.ok) {\r\n          return res.json()\r\n        }\r\n\r\n        throw new Error(errorMessage)\r\n      })\r\n  }\r\n\r\n  static getContacts() {\r\n    return ContactAPI.request('','GET','','Can not retrieve contacts from server')\r\n  }\r\n\r\n  static createContact(data) {\r\n    return ContactAPI.request('', 'POST', data, 'Can not create contact on server')\r\n  }\r\n\r\n  static updateContact(id, changes) {\r\n    return ContactAPI.request(id, 'PUT', changes, 'Can not update contact on server')\r\n  }\r\n\r\n  static deleteContact(id) {\r\n    return ContactAPI.request(id, 'DELETE', '', 'Can not delete contact on server')\r\n  }\r\n}\nconst SELECTOR_CONTACT_ROW = '.contactRow'\r\nconst SELECTOR_DELETE_BTN = '.deleteBtn'\r\nconst SELECTOR_EDIT_BTN = '.editBtn'\r\nconst contactForm = document.querySelector('#contactForm')\r\nconst $contactContainer = $('#contactContainer')\r\nlet contactList = []\r\n\r\ncontactForm.addEventListener('submit', onContactFormSubmit)\r\n$contactContainer\r\n  .on('click', SELECTOR_DELETE_BTN, deleteContactEl)\r\n  .on('click', SELECTOR_EDIT_BTN, editContactEl)\r\n\r\nContactAPI.getContacts()\r\n  .then((contacts) => {\r\n    renderContactsList(contacts)\r\n    contactList = contacts\r\n  })\r\n  .catch(e => showError(e))\r\n\r\nfunction onContactFormSubmit(e) {\r\n  e.preventDefault()\r\n\r\n  const data = getData()\r\n\r\n  if (!isValidData(data)) {\r\n    showError(new Error('You must enter correct data'))\r\n    return\r\n  }\r\n\r\n  if (data.id) {\r\n    ContactAPI.updateContact(data.id, data)\r\n      .then((newData) => {\r\n        changeContact(data.id, newData)\r\n        clearForm()\r\n        contactList = contactList.map(contactItem => contactItem.id === data.id ? newData : contactItem)\r\n      })\r\n      .catch(e => showError(e))\r\n  } else {\r\n    ContactAPI.createContact(data)\r\n      .then((data) => {\r\n        renderContacts(data)\r\n        clearForm()\r\n        contactList.push(data)\r\n      })\r\n      .catch(e => showError(e))\r\n  }\r\n}\r\n\r\nfunction deleteContactEl(e) {\r\n  const target = e.target\r\n  const contactEl = findContactEl(target)\r\n  const id = getContactElId(contactEl)\r\n\r\n  ContactAPI.deleteContact(id)\r\n    .then(() => {\r\n      contactEl.remove()\r\n    })\r\n    .catch(e => showError(e))\r\n\r\n  contactList = contactList.filter(contactItem => contactItem.id !== id)\r\n}\r\n\r\nfunction findContactEl(el) {\r\n  return el.closest(SELECTOR_CONTACT_ROW)\r\n}\r\n\r\nfunction editContactEl(e) {\r\n  const target = e.target\r\n  const contactEl = findContactEl(target)\r\n  const id = getContactElId(contactEl)\r\n  const contact = findContactById(id)\r\n\r\n  fillForm(contact)\r\n}\r\n\r\nfunction getData() {\r\n  const id = contactForm.hiddenInput.value\r\n  const editContact = findContactById(id) || {}\r\n\r\n  return {\r\n    ...editContact,\r\n    name: contactForm.nameInput.value,\r\n    surname: contactForm.surnameInput.value,\r\n    phone: contactForm.phoneInput.value,\r\n  }\r\n}\r\n\r\nfunction isValidData(data) {\r\n  return data.name\r\n    && data.surname\r\n    && data.phone\r\n}\r\n\r\nfunction showError(error) {\r\n  alert(error.message)\r\n}\r\n\r\nfunction renderContactsList(data) {\r\n  const html = data.map(generateContactsHtml)\r\n\r\n  $contactContainer.html(html)\r\n}\r\n\r\nfunction renderContacts(data) {\r\n  const htmlItem = generateContactsHtml(data)\r\n\r\n  $contactContainer.append(htmlItem)\r\n}\r\n\r\nfunction changeContact(id, data) {\r\n  const oldContactEl = document.querySelector(`[data-id=\"${id}\"]`)\r\n  oldContactEl.outerHTML = generateContactsHtml(data)\r\n}\r\n\r\nfunction generateContactsHtml(value) {\r\n  return `\r\n    <tr class=\"contactRow\" data-id=\"${value.id}\">\r\n      <td>${value.name}</td>\r\n      <td>${value.surname}</td>\r\n      <td>${value.phone}</td>\r\n      <td>\r\n        <button class=\"editBtn\">Edit</button>\r\n        <button class=\"deleteBtn\">Delete</button>\r\n      </td>\r\n    </tr>\r\n  `\r\n}\r\n\r\nfunction clearForm() {\r\n  contactForm.reset()\r\n  contactForm.hiddenInput.value = ''\r\n}\r\n\r\nfunction getContactElId(el) {\r\n  return el.dataset.id\r\n}\r\n\r\nfunction findContactById(id) {\r\n  return contactList.find(data => data.id === id)\r\n}\r\n\r\nfunction fillForm (contact) {\r\n  contactForm.hiddenInput.value = contact.id\r\n  contactForm.nameInput.value = contact.name\r\n  contactForm.surnameInput.value = contact.surname\r\n  contactForm.phoneInput.value = contact.phone\r\n}"],"names":["ContactAPI","API","request","url","method","body","errorMessage","fetch","JSON","stringify","undefined","headers","Content-type","then","res","ok","json","Error","getContacts","createContact","data","updateContact","id","changes","deleteContact","SELECTOR_CONTACT_ROW","SELECTOR_DELETE_BTN","SELECTOR_EDIT_BTN","contactForm","document","querySelector","$contactContainer","$","let","contactList","onContactFormSubmit","e","preventDefault","getData","isValidData","changeContact","newData","clearForm","map","contactItem","catch","showError","renderContacts","push","deleteContactEl","contactEl","findContactEl","target","getContactElId","remove","filter","el","closest","editContactEl","fillForm","findContactById","hiddenInput","value","name","nameInput","surname","surnameInput","phone","phoneInput","error","alert","message","renderContactsList","html","generateContactsHtml","htmlItem","append","outerHTML","reset","dataset","find","contact","addEventListener","on","contacts"],"mappings":"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"}